<!DOCTYPE html>
<html>

  <head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>How to Make Money Using Grep Sed and Awk - Open Monster Vision</title>
<meta name="description" content="The Who I&amp;rsquo;m your friendly neighborhood unix man. And I have a problem. I love regex. Now I have two problems.
The Why Recently I have become destitute so I have taken to using the skills I have to provide for my poor sick family. It&amp;rsquo;s mostly disabled cats. And when all you have is hammer, everything gets nailed. So I thought, you know what people probably don&amp;rsquo;t automate enough of&amp;hellip;Data Entry."/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="https://openmonstervision.github.io/blog/posts/how-to-make-money-using-grep-sed-and-awk/" />


<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="The Who I&amp;rsquo;m your friendly neighborhood unix man. And I have a problem. I love regex. Now I have two problems.
The Why Recently I have become destitute so I have taken to using the skills I have to provide for my poor sick family. It&amp;rsquo;s mostly disabled cats. And when all you have is hammer, everything gets nailed. So I thought, you know what people probably don&amp;rsquo;t automate enough of&amp;hellip;Data Entry." />
<meta name="twitter:title" content="How to Make Money Using Grep Sed and Awk - Open Monster Vision" />
<meta name="twitter:site" content="" />
<meta name="twitter:creator" content="" />


<meta property="og:type" content="article" />
<meta content="How to Make Money Using Grep Sed and Awk - Open Monster Vision" property="og:title">
<meta content="The Who I&amp;rsquo;m your friendly neighborhood unix man. And I have a problem. I love regex. Now I have two problems.
The Why Recently I have become destitute so I have taken to using the skills I have to provide for my poor sick family. It&amp;rsquo;s mostly disabled cats. And when all you have is hammer, everything gets nailed. So I thought, you know what people probably don&amp;rsquo;t automate enough of&amp;hellip;Data Entry." property="og:description">
<meta property="og:url" content="https://openmonstervision.github.io/blog/posts/how-to-make-money-using-grep-sed-and-awk/" />
<meta property="og:site_name" content="Open Monster Vision" />

<meta property="article:published_time" content="2017-10-10 04:53:45 -0500 CDT" />





<script type="application/ld+json">
{ 
    "@context": "http://schema.org", 
    "@type": "BlogPosting",
    "headline": "How to Make Money Using Grep Sed and Awk",
    "genre": "",  
    "url": "https:\/\/openmonstervision.github.io\/blog\/posts\/how-to-make-money-using-grep-sed-and-awk\/",
    "datePublished": "2017-10-10 04:53:45 -0500 CDT",
    "description": "The Who I\x26rsquo;m your friendly neighborhood unix man. And I have a problem. I love regex. Now I have two problems.\nThe Why Recently I have become destitute so I have taken to using the skills I have to provide for my poor sick family. It\x26rsquo;s mostly disabled cats. And when all you have is hammer, everything gets nailed. So I thought, you know what people probably don\x26rsquo;t automate enough of\x26hellip;Data Entry.",
    "author": {
        "@type": "Person",
        "name": ""
    }
 }
</script>




<link rel="stylesheet" href="https://openmonstervision.github.io/blog/sass/main.css">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
</head>


  <body>

    <header class="site-header">
<nav class="navbar navbar-default">
  <div class="container-fluid">
    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://openmonstervision.github.io/blog/">Open Monster Vision</a>
    </div>

    
    <div class="collapse navbar-collapse " id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
        <li><a href="https://openmonstervision.github.io/blog/pages/about/">About</a></li>
        <li><a href="https://openmonstervision.github.io/blog/pages/contact/">Contact</a></li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Download <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a target="_blank" href="https://github.com/bul-ikana/hugo-cards">Project</a></li>
            <li><a href="https://github.com/bul-ikana/hugo-cards.git">Download</a></li>
            <li role="separator" class="divider"></li>
            <li><a target="_blank" href="https://themes.gohugo.io/">More Themes</a></li>
          </ul>
        </li>
      </ul>
    </div>
  </div>
</nav>
</header>


    <div class="container">
      <div class="wrapper">
        
<div class="row">
<div class="col-md-8">
    <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

          <header class="post-header">
            <h1 class="post-title" itemprop="name headline">How to Make Money Using Grep Sed and Awk</h1>
            <p class="post-meta"><time datetime='2017-10-10T04:53:45-05:00' itemprop="datePublished">October 10, 2017</time></p>
                 
          </header>

          <div class="post-content" itemprop="articleBody">
            

<p><link rel="stylesheet" href="https://openmonstervision.github.io/blog/css/prism.css" />
<script src="https://openmonstervision.github.io/blog/js/prism.js" type="text/javascript"></script></p>

<h1 id="the-who">The Who</h1>

<p>I&rsquo;m your friendly neighborhood unix man. And I have a problem. I love regex. Now I have two problems.</p>

<h1 id="the-why">The Why</h1>

<p>Recently I have become destitute so I have taken to using the skills I have to provide for my poor sick family. It&rsquo;s mostly <a href="https://www.instagram.com/bsdpunk/" title="BSDPunk Instagram">disabled cats</a>. And when all you have is hammer, everything gets nailed. So I thought, you know what people probably don&rsquo;t automate enough of&hellip;Data Entry. I logged onto a freelance site of my choice, <a href="https://www.upwork.com/" title="Upwork">upwork</a>. And found exactly what I wanted. Someone who wanted to turn a PDF into a csv. Particularly, a parts catalog into a shopify CSV.</p>

<h1 id="the-good">The Good</h1>

<p>The pdf was easy enough to convert into text, originally I thought I would convert all the pages into tiff&rsquo;s and use tesseract to OCR the characters. As it turned out this PDF was all selectable text, and just using pdftotext was sufficient.</p>

<p>For Mac:</p>

<pre><code class="language-bash">brew install pdftotext
brew install tesseract
</code></pre>

<p>All and all when this hideous brain child was finished, I had about an 87 percent success rate.</p>

<h1 id="the-bad">The Bad</h1>

<p>There are things I regret, and things I regret. I am ashamed to admit this but one of the earlier things I did was strip all the quotes out of the resulting pdftotext file. Which was mostly so I could clean up the commas using this function:</p>

<pre><code class="language-bash">function rqc () { awk -F'&quot;' -v OFS='' '{ for (i=2; i&lt;=NF; i+=2) gsub(&quot;,&quot;, &quot;&quot;, $i) } 1' $@ | sed 's/&quot;//g' ;}
</code></pre>

<p>This functions basically removes all the commas in between quotes in a csv, then removes the quotes. Yeah, for sure, there were better ways to deal with that. But it&rsquo;s not like I have a peer group of other regexers at beck and call.</p>

<h1 id="the-ugly">The Ugly</h1>

<p>Let&rsquo;s look at the code:</p>

<pre><code class="language-bash">set -o nounset                              # Treat unset variables as an error
BROAD=$(grep '[A-Z]\.' c.txt -A2 -B9)
#List of all Skus
#LIST=$(grep -P -o '\d{5}-\d{2}\w{0,1}' c.txt | sort | uniq )
LIST=$( grep -o '^[0-9]\{7,8\}' c.txt | sort | uniq  )
#Temp for checking if adjacent price
TEMP=0
for n in $(cat &lt;(echo $LIST) )
do
    #Get Name
    NAME=$( grep &quot;$n&quot; c.txt  -B9 | grep '^[A-Z]\.' | sed 's/^[A-Z]\. //' | sed 's/^[A-Z ]\+       \([A-Z][a-z]\)/\1/' | sed 's/&quot;//g' | grep '[A-Z ]\+' | tail -n1 | sed 's/[a-z].*//' | sed 's/.$//' )
    #Get Body
    DESCRIPTION=$( grep &quot;$n&quot; c.txt  -B9 | grep '^[A-Z]\.' | sed 's/^[A-Z]\. //' | sed 's/^[A-Z ]\+\([A-Z][a-z]\)/\1/' | sed 's/&quot;//g')

    if [[  -z $NAME ]]
    then
        NAME=$( grep $n c.txt  -B10 | grep '^[A-Z]\+' | head -n1 | sed 's/^[A-Z]\. //' | sed 's/[A-Z][a-z].*//g')
    fi
    #Get Handle
    HANDLE=$( echo $NAME | tr '[A-Z]' '[a-z]' | sed 's/ /-/g' | sed &quot;s/$/-${n}/&quot;| sed 's/[A-Z][a-z]//' )

    #Get Price
    PRICE=$(grep &quot;$n&quot; c.txt -A6 | grep -P '${n} $\d+\.\d+' -o | grep -P '\d+\.\d+' -o)
    if [[  -z $PRICE ]]
    then
        PRICE=$(grep &quot;$n&quot; c.txt -A6 | grep -P -o '\$\d+\.\d+' | sed 's/\$//g' |tr ' ' '\n' | head -n1)
    fi
    # Do Var Price Math
    FIFTEEN=$( echo &quot;scale=2; (${PRICE}) * .15&quot; | bc )
    VARPRICE=$( echo &quot;scale=2; ${PRICE} - $FIFTEEN&quot;| bc )
    # Add Sku to Name
    NAME=$(echo $NAME | sed &quot;s/$/ - ${n}/&quot; )
    if [[ ! -z $n ]]
    then
        FINAL=$(echo &quot;\&quot;$HANDLE\&quot;, \&quot;$NAME\&quot; , \&quot;$DESCRIPTION\&quot;, \&quot;Vendor\&quot;, \&quot;\&quot; , , \&quot;\&quot;, \&quot;Title\&quot;, \&quot;Default Title\&quot;, , , , , \&quot;$n\&quot;, ,,,,,\&quot;$VARPRICE\&quot;,\&quot;$PRICE\&quot;&quot;)
    fi
    if [[ ! -z $FINAL ]]
    then
        echo $FINAL
    fi
done

</code></pre>

<h2 id="a-note-about-bsd-tools-vs-gnu-tools">A note about BSD tools vs GNU tools</h2>

<p>I started doing this on my macbook air, Mac OS X uses the bsd cousins of grep and sed. More and more, for various reasons I saw myself using ggrep and gsed, rather than grep and sed. Mostly because of how the BSD sed deals with new lines, and because on occasion I wanted to use PCRE regex with grep, ie the -P flag. Eventually I fully switched to a linux enviroment, using the GNU toolset. The final straw actually had nothing to do with the tools, the resolution\screen space on MacBook Air, didn&rsquo;t allow me to see the lines the way I wanted them in a vimdiff. So I switched to a debian system in the final rounds of the script.</p>

<h1 id="hey-guys-don-t-forget-about-my-poor-cats">Hey Guys Don&rsquo;t Forget about my poor cats</h1>

<p>My cats, they are <a href="https://www.instagram.com/p/BZ7QyBZjbu0/?taken-by=bsdpunk" title="Felicity">blind</a>, they are missing <a href="https://www.instagram.com/p/BZ7Kw9qjG5E/?taken-by=bsdpunk" title="Charlie">limbs</a>. Please purchase a book about <a href="https://www.amazon.com/gp/product/0596528124/ref=as_li_qf_sp_asin_il_tl?ie=UTF8&amp;tag=bsdpblog-20&amp;camp=1789&amp;creative=9325&amp;linkCode=as2&amp;creativeASIN=0596528124&amp;linkId=889140c1615f2cd3e4373dfe9ebc0be7" title="Regex Book Amazon">regex</a> Or a book about <a href="https://www.amazon.com/gp/product/1430219483/ref=as_li_qf_sp_asin_il_tl?ie=UTF8&amp;tag=bsdpblog-20&amp;camp=1789&amp;creative=9325&amp;linkCode=as2&amp;creativeASIN=1430219483&amp;linkId=b43558af067f9b7ba9b51c625832d542" title="Coders At Work, Amazon">successful coders</a></p>

          </div>

    </article>
    <div class="row">
        
    </div>
    
    <div class="row">
            <ul class="pager">
             
                    <li><a class="next" href="https://openmonstervision.github.io/blog/posts/building-a-neural-net-to-predict-tom-bradys-fantasy-points/">&laquo; Building a Neural Net to Predict Tom Brady&#39;s Fantasy Points</a></li>
              
              
                <li><a class="previous" href="https://openmonstervision.github.io/blog/posts/how-not-to-get-a-job-with-an-elite-tech-company/">How Not to Get a Job With an Elite Tech Company &raquo;</a></li>
              
            </ul>
    </div>
</div>


<div class="col-md-4 mt20">
        <div class="post-img">
           
            <img width="600" src="https://openmonstervision.github.io/blog/images/gopher.png" alt="webjeda">
            
        </div>
            
        
        <div class="mt10 recent">
            <h2>Recent articles</h2>        
             <ul>
                

                      <li>
                      <p><a href="https://openmonstervision.github.io/blog/posts/the-curious-case-of-new-bremem/">The Curious Case of New Bremem, a DevOps interview with Crown Equipment</a><small>&nbsp;&nbsp;October 24, 2019</small></p>
                      </li>

                

                      <li>
                      <p><a href="https://openmonstervision.github.io/blog/posts/automating-your-dm-workflow-dndshell/">Automating your DM workflow with Dndshell</a><small>&nbsp;&nbsp;October 21, 2019</small></p>
                      </li>

                

                      <li>
                      <p><a href="https://openmonstervision.github.io/blog/posts/i-guess-i-ll-switch-to-zsh-thanks-apple/">I guess I&#39;ll switch to zsh, thanks Apple</a><small>&nbsp;&nbsp;October 21, 2019</small></p>
                      </li>

                
              </ul>
        </div>
        
        <br>

</div>

</div>




      </div>
    </div>

    <footer>
    <div class="container">
        <div class="row p20">
            

            <div class="col-md-4 text-center mt25" >
                
            </div>
            <div class="col-md-4 text-center mt25">
               
               
               
               
               
            </div>

        </div> 
    </div>
    <div id="amzn-assoc-ad-c303d031-08ef-4838-888f-edfa4b49a51c"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&adInstanceId=c303d031-08ef-4838-888f-edfa4b49a51c"></script>
</footer>
    

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
  <script src="https://openmonstervision.github.io/blog//js/bootstrap.min.js"></script>
  
  </body>

</html>